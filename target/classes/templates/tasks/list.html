<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Task Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">
<h1>Task Tracker</h1>

<form th:action="@{/tasks}" th:object="${task}" method="post" class="mb-4 p-4 border rounded shadow-sm">
    <input type="hidden" th:field="*{id}">
    <div class="row g-3">
        <div class="col-md-4">
            <input type="text" th:field="*{name}" class="form-control" placeholder="Nazwa zadania">
        </div>
        <div class="col-md-4">
            <input type="text" th:field="*{description}" class="form-control" placeholder="Opis">
        </div>
        <div class="col-md-4">
            <button type="submit" class="btn w-100"
                    th:classappend="${task.id != null} ? 'btn-warning' : 'btn-success'">
                <i th:class="${task.id != null} ? 'fas fa-edit' : 'fas fa-plus'"></i>
                <span th:text="${task.id != null} ? 'Edytuj zadanie' : 'Dodaj zadanie'"></span>
            </button>
        </div>
    </div>
</form>

<div class="row mb-4">
    <div class="col-md-4">
        <form action="/tasks/search" method="get" class="d-flex">
            <input type="text" name="name" placeholder="Szukaj nazwy..." class="form-control me-2">
            <button class="btn btn-outline-primary">Szukaj</button>
        </form>
    </div>
    <div class="col-md-4">
        <a href="/tasks/completed" class="btn btn-success">Ukończone</a>
    </div>
    <div class="col-md-4">
        <a href="/tasks" class="btn btn-secondary">Wszystkie</a>
    </div>
</div>

<table class="table table-striped">
    <thead><tr><th>ID</th><th>Nazwa</th><th>Opis</th><th>Status</th><th></th></tr></thead>
    <tbody>
    <tr th:each="task : ${tasks}">
        <td th:text="${task.id}"></td>
        <td th:text="${task.name}"></td>
        <td th:text="${task.description}"></td>
        <td th:text="${task.completed ? '✅' : '⏳'}"></td>
        <td>
            <a th:href="@{/tasks/edit/{id}(id=${task.id})}" class="btn btn-sm btn-warning">Edytuj</a>
            <a th:href="@{/tasks/toggle/{id}(id=${task.id})}"
               class="btn btn-sm btn-info">
                <i th:class="${task.completed ? 'fas fa-undo' : 'fas fa-check'}"></i>
                <span th:text="${task.completed ? 'Ponów' : 'Skończone'}"></span>
            </a>
            <form th:action="@{/tasks/delete/{id}(id=${task.id})}" method="post" style="display:inline">
                <button class="btn btn-sm btn-danger" onclick="return confirm('Usunąć?')">Usuń</button>
            </form>
        </td>
    </tr>
    </tbody>
</table>
</body>
</html>
